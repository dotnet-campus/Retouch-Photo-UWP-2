<UserControl
    x:Class="Retouch_Photo2.Controls.LayersControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:extensions="using:Microsoft.Toolkit.Uwp.UI.Extensions"
    xmlns:conLayersControls="using:Retouch_Photo2.Controls.LayersControls"
    xmlns:models="using:Retouch_Photo2.Models"
    mc:Ignorable="d"
    d:DesignHeight="800"
    d:DesignWidth="200">


    <UserControl.Resources>

        <!--DataTemplate-->
        <DataTemplate x:Key="DataTemplate" x:DataType="models:Layer">
            <Grid Background="Transparent" Tapped="{x:Bind RootGrid_Tapped}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="34"/>
                    <ColumnDefinition Width="40"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="1"/>
                    <ColumnDefinition Width="34"/>
                </Grid.ColumnDefinitions>

                <!--Background-->
                <Border Grid.Column="0" Background="{ThemeResource SystemControlHighlightAltListAccentMediumBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}"/>
                <Border Grid.Column="1" Grid.ColumnSpan="2" Background="{ThemeResource SystemControlHighlightAltListAccentHighBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}"/>
                <Border Grid.Column="3" Grid.ColumnSpan="2" Background="{ThemeResource SystemControlHighlightAltListAccentLowBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}"/>

                <!--IsChecked-->
                <Border Grid.Column="0" Width="22">
                    <CheckBox IsChecked="{x:Bind IsChecked,Mode=TwoWay}" Tapped="CheckBox_Tapped"/>
                </Border>

                <!--Icon-->
                <Border Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Child="{x:Bind Icon,Mode=OneWay}">
                </Border>

                <!--Text-->
                <TextBlock Grid.Column="2" Margin="2,0" VerticalAlignment="Center" Text="{x:Bind Text,Mode=OneWay}"/>
                <Rectangle Grid.Column="3" Height="28" Fill="{ThemeResource SystemControlBackgroundBaseLowBrush}" Opacity="0.5"/>

                <!--IsVisual-->
                <Button Grid.Column="4" BorderThickness="0" BorderBrush="Transparent" Background="Transparent" Padding="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Tapped="{x:Bind VisualButton_Tapped}">
                    <FontIcon Glyph="&#x1F441;" FontSize="26" FontFamily="Segoe UI Symbol" Opacity="{x:Bind BoolToOpacityConverter(IsVisual),Mode=OneWay}"/>
                </Button>

            </Grid>

        </DataTemplate>
        
        <!--Flyout-->
        <Flyout x:Name="PropertyFlyout" Placement="Left" FlyoutPresenterStyle="{StaticResource AppFlyoutPresenterStyle }">
            <conLayersControls:LayerControl Width="222" Layer="{x:Bind ViewModel.Layer,Mode=OneWay}"/>
        </Flyout>
        
        <!--Style-->
        <Style x:Key="AppListViewStyle" TargetType="ListView">
 

            <Setter Property="AllowDrop" Value="True"/>
            <Setter Property="CanDrag" Value="True"/>
            <Setter Property="CanDragItems" Value="True"/>
            <Setter Property="CanReorderItems" Value="True"/>
            <Setter Property="ReorderMode" Value="Enabled"/>
            <Setter Property="SelectionMode" Value="None"/>

            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="TabNavigation" Value="Once"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>

            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="MinHeight" Value="90"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>

            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Hidden"/>
            <Setter Property="ScrollViewer.HorizontalScrollMode" Value="Disabled"/>
            <Setter Property="ScrollViewer.IsHorizontalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.VerticalScrollMode" Value="Enabled"/>
            <Setter Property="ScrollViewer.IsVerticalRailEnabled" Value="True"/>
            <Setter Property="ScrollViewer.ZoomMode" Value="Disabled"/>

            <Setter Property="ScrollViewer.IsDeferredScrollingEnabled" Value="False"/>
            <Setter Property="ScrollViewer.BringIntoViewOnFocusChange" Value="True"/>
            <Setter Property="ItemContainerTransitions">
                <Setter.Value>                    
                    <TransitionCollection> 
                                       <!--               <ReorderThemeTransition />

                        <AddDeleteThemeTransition />
                        <ContentThemeTransition />
                     <EntranceThemeTransition IsStaggeringEnabled="False" />
                     -->
                    </TransitionCollection>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <ItemsStackPanel ItemsUpdatingScrollMode="KeepLastItemInView" VerticalAlignment="Bottom"/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--ItemContainerStyle-->
        <Style x:Key="AppItemContainerStyle" TargetType="ListViewItem">
            <Setter Property="MinWidth" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        </Style>

    </UserControl.Resources>

    
    <ListView  x:Name="ListView"
                
               SelectedIndex="{x:Bind ViewModel.Index,Mode=TwoWay}"
               
               ItemsSource="{x:Bind ViewModel.RenderLayer.Layers}"
               ItemTemplate="{StaticResource DataTemplate}"
                                           
               Style="{StaticResource AppListViewStyle}"
               ItemContainerStyle="{StaticResource AppItemContainerStyle}"
                              
               extensions:ListViewExtensions.AlternateColor="{ThemeResource SystemControlBackgroundListLowBrush}"
               >
        
        <ListView.Header>
            <Button x:Name="AddButton" Width="Auto" Height="44" Content="&#xE109;" HorizontalAlignment="Stretch" Style="{ThemeResource NavigationBackButtonNormalStyle}"/>
        </ListView.Header>
    </ListView>
    
</UserControl>
