<UserControl
    x:Class="Retouch_Photo2.Controls.LayersControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:layers="using:Retouch_Photo2.Layers"
    mc:Ignorable="d"
    d:DesignHeight="800"
    d:DesignWidth="200"
    >    
    
    <UserControl.Resources>

        <!--DataTemplate-->
        <DataTemplate x:Key="DataTemplate" x:DataType="layers:Layer">
            <Grid x:Name="RootGrid" Background="Transparent" Tapped="RootGrid_Tapped" RightTapped="RootGrid_RightTapped">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30"/>
                    <ColumnDefinition Width="38"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="1"/>
                    <ColumnDefinition Width="30"/>
                </Grid.ColumnDefinitions>

                <!--Background-->
                <Border IsHitTestVisible="False" Grid.Column="0" Background="{ThemeResource SystemControlHighlightAltListAccentMediumBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}"/>
                <Border IsHitTestVisible="False" Grid.Column="1" Grid.ColumnSpan="2" Background="{ThemeResource SystemControlHighlightAltListAccentHighBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}"/>
                <Border IsHitTestVisible="False" Grid.Column="3" Grid.ColumnSpan="2" Background="{ThemeResource SystemControlHighlightAltListAccentLowBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}"/>

                <!--CheckBox-->
                <Button x:Name="CheckBox" Grid.Column="0" BorderThickness="0" BorderBrush="Transparent" Background="Transparent" Padding="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Tapped="CheckBox_Tapped">
                    <Border IsHitTestVisible="False" Width="20" Height="20" BorderThickness="1" BorderBrush="{ThemeResource SystemControlBackgroundBaseHighBrush}" >
                        <Border Background="{ThemeResource SystemControlHighlightAltListAccentHighBrush}" Visibility="{x:Bind BoolToVisibilityConverter(IsChecked),Mode=OneWay}">
                            <FontIcon Glyph="&#xE001;" FontSize="20" Foreground="White" FontFamily="{ThemeResource SymbolThemeFontFamily}"/>
                        </Border>
                    </Border>
                </Button>

                <!--Icon-->
                <Border Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Child="{x:Bind Icon,Mode=OneWay}"/>

                <!--Text-->
                <TextBlock Grid.Column="2" VerticalAlignment="Center">
                    <Run Text="{x:Bind Name,Mode=OneWay}"/>
                    <Run Foreground="{ThemeResource AppText}">(</Run>
                    <Run Text="{x:Bind Type,Mode=OneWay}" Foreground="{ThemeResource AppText}"/>
                    <Run Foreground="{ThemeResource AppText}">)</Run>
                </TextBlock>
                <Rectangle Grid.Column="3" Height="28" Fill="{ThemeResource SystemControlBackgroundBaseLowBrush}" Opacity="0.5"/>

                <!--Visibility-->
                <Button x:Name="VisibilityButton" Grid.Column="4" BorderThickness="0" BorderBrush="Transparent" Background="Transparent" Padding="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Tapped="VisibilityButton_Tapped">
                    <FontIcon Glyph="&#xE7B3;" FontSize="22" FontFamily="{StaticResource SymbolThemeFontFamily}" Opacity="{x:Bind VisibilityToOpacityConverter(Visibility),Mode=OneWay}"/>
                </Button>

            </Grid>
        </DataTemplate>

        <!--Style-->
        <Style x:Key="ListViewStyle" TargetType="ListView">

            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="TabNavigation" Value="Once"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>

            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="MinHeight" Value="90"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>

            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Hidden"/>
            <Setter Property="ScrollViewer.HorizontalScrollMode" Value="Disabled"/>
            <Setter Property="ScrollViewer.IsHorizontalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.VerticalScrollMode" Value="Enabled"/>
            <Setter Property="ScrollViewer.IsVerticalRailEnabled" Value="True"/>
            <Setter Property="ScrollViewer.ZoomMode" Value="Disabled"/>

            <Setter Property="ScrollViewer.IsDeferredScrollingEnabled" Value="False"/>
            <Setter Property="ScrollViewer.BringIntoViewOnFocusChange" Value="True"/>
            <Setter Property="ItemContainerTransitions">
                <Setter.Value>
                    <TransitionCollection>
                       
                        <ReorderThemeTransition />

                        <AddDeleteThemeTransition />
                        <ContentThemeTransition />
                        <EntranceThemeTransition IsStaggeringEnabled="False" />
                          <!--          -->
                    </TransitionCollection>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <ItemsStackPanel ItemsUpdatingScrollMode="KeepLastItemInView" VerticalAlignment="Bottom"/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--ItemContainerStyle-->
        <Style x:Key="ItemContainerStyle" TargetType="ListViewItem">
            <Setter Property="MinWidth" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        </Style>

    </UserControl.Resources>


    <Grid>
        
        <Canvas>
            <Border x:Name="IndicatorBorder" MinWidth="50" Height="40"/>
        </Canvas>
        
        <ListView x:Name="ListView"
                               
               ItemsSource="{x:Bind ViewModel.Layers}"
               ItemTemplate="{StaticResource DataTemplate}"
                                           
               Style="{StaticResource ListViewStyle}"
               ItemContainerStyle="{StaticResource ItemContainerStyle}"
               >

            <ListView.Header>
                <Button x:Name="AddButton" Height="42" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Content="&#xE109;" FontFamily="{ThemeResource SymbolThemeFontFamily}" BorderThickness="0" BorderBrush="Transparent" Background="Transparent"/>
            </ListView.Header>

        </ListView>
    </Grid>

</UserControl>