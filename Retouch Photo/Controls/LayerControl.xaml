<UserControl
    x:Class="Retouch_Photo.Controls.LayerControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:canvas="using:Microsoft.Graphics.Canvas.UI.Xaml"
    xmlns:extensions="using:Microsoft.Toolkit.Uwp.UI.Extensions"
    xmlns:conLayerControls="using:Retouch_Photo.Controls.LayerControls"
    xmlns:models="using:Retouch_Photo.Models"
    mc:Ignorable="d"
    d:DesignHeight="800"
    d:DesignWidth="200">


    <UserControl.Resources>

        <!--DataTemplate-->
        <DataTemplate x:Key="DataTemplate" x:DataType="models:Layer">
            <conLayerControls:LayoutControl Layer="{x:Bind}" FlyoutShow="LayoutControl_FlyoutShow"/>
        </DataTemplate>
        
        <!--Flyout-->
        <Flyout x:Name="PropertyFlyout" Placement="Left" FlyoutPresenterStyle="{StaticResource AppFlyoutPresenterStyle }">
            <conLayerControls:FlyoutControl x:Name="FlyoutControl"/>
        </Flyout>
        
        <!--Style-->
        <Style x:Key="AppListViewStyle" TargetType="ListView">

            
            <Setter Property="AllowDrop" Value="True"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="CanReorderItems" Value="True"/>

            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="TabNavigation" Value="Once"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>

            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="MinHeight" Value="90"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>

            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Hidden"/>
            <Setter Property="ScrollViewer.HorizontalScrollMode" Value="Disabled"/>
            <Setter Property="ScrollViewer.IsHorizontalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.VerticalScrollMode" Value="Enabled"/>
            <Setter Property="ScrollViewer.IsVerticalRailEnabled" Value="True"/>
            <Setter Property="ScrollViewer.ZoomMode" Value="Disabled"/>

            <Setter Property="ScrollViewer.IsDeferredScrollingEnabled" Value="False"/>
            <Setter Property="ScrollViewer.BringIntoViewOnFocusChange" Value="True"/>
            <Setter Property="ItemContainerTransitions">
                <Setter.Value>                    
                    <TransitionCollection> 
                        <!--
                        <AddDeleteThemeTransition />
                        <ContentThemeTransition />
                        <ReorderThemeTransition />
                        <EntranceThemeTransition IsStaggeringEnabled="False" />
                        -->
                    </TransitionCollection>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <ItemsStackPanel ItemsUpdatingScrollMode="KeepLastItemInView" VerticalAlignment="Bottom"/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--ItemContainerStyle-->
        <Style x:Key="AppItemContainerStyle" TargetType="ListViewItem">
            <Setter Property="MinWidth" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
        </Style>

    </UserControl.Resources>

    
    <ListView  x:Name="ListView"
                
               SelectedIndex="{x:Bind ViewModel.SelectedIndex,Mode=TwoWay}"
               SelectionChanged="ListView_SelectionChanged"
               
               ItemsSource="{x:Bind ViewModel.RenderLayer.Layers}"
               ItemTemplate="{StaticResource DataTemplate}"
                            
               IsItemClickEnabled="True" ItemClick="ListView_ItemClick"
               
               Style="{StaticResource AppListViewStyle}"
               ItemContainerStyle="{StaticResource AppItemContainerStyle}"
                              
               extensions:ListViewExtensions.AlternateColor="{ThemeResource SystemControlBackgroundListLowBrush}"
               >
        
        <ListView.Header>
            <Button x:Name="AddButton" Width="Auto" Height="44"  Content="&#xE109;" HorizontalAlignment="Stretch" Style="{ThemeResource NavigationBackButtonNormalStyle}" Tapped="AddButton_Tapped"/>
        </ListView.Header>
    </ListView>
    
</UserControl>
